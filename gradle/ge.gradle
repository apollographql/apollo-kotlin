
def isCI = System.getenv("CI") != null

gradleEnterprise {
  server = "https://ge.apollographql.com"
  allowUntrustedServer = false

  buildScan {
    publishAlways()
    publishIfAuthenticated()
    tag("exp5-take4")

    uploadInBackground = !isCI

    capture {
      taskInputFiles = true
    }
  }
}


buildCache {
  local {
    enabled = false
  }
  remote(HttpBuildCache) {
    url = 'https://ge.apollographql.com/cache/exp5-take4/'
    enabled = true
    push = isCI
    credentials { creds ->
      // inject credentials with read-write access to the remote build cache via env vars set in your CI environment
      creds.username = System.getenv('GRADLE_ENTERPRISE_CACHE_USERNAME')
      creds.password = System.getenv('GRADLE_ENTERPRISE_CACHE_PASSWORD')
    }
  }
}