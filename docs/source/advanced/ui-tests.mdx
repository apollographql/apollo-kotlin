---
title: UI Tests
---

import {MultiCodeBlock} from 'gatsby-theme-apollo-docs';

Apollo Android offers a built-in [IdlingResource](https://developer.android.com/reference/androidx/test/espresso/IdlingResource) to help writing UI tests with Espresso. The `ApolloIdlingResource` will make sure that your tests wait for your GraphQL queries terminate before moving on with testing.

Add the `apollo-idling-resource` `dependency`:

```kotlin:title=build.gradle[.kts]
implementation("com.apollographql.apollo3:apollo-idling-resource:x.y.z")
```

> Note: If you have multiple `ApolloClients` you need to create and register multiple `ApolloIdlingResource` with different names. Registering several IdlingResources with the same name will crash.

```kotlin
// Create your IdlingResource
val idlingResource = ApolloIdlingResource("apolloIdlingResource")

// Register the idlingResource before running your tests (once per client).
IdlingRegistry.getInstance().register(idlingResource)

// Intruct your ApolloClient to update the IdlingResource
val apolloClient = ApolloClient.Builder()
    .serverUrl("https://example.com/graphql")
    .idlingResource(idlingResource)
    .build()
```

All operations (except subscriptions that might run a long time) going through apolloClient will update the IdlingResource so that no automatic action will take place while your app is waiting for some data.

