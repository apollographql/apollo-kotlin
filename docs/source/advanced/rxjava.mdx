---
title: 'RxJava support'
---

import {MultiCodeBlock} from 'gatsby-theme-apollo-docs';

If you're using Apollo Android in a [Java project](java) or a Kotlin project that uses RxJava, you can use Apollo's RxJava extensions.

To do so, add the `apollo-rx2-support` or `apollo-rx3-support` dependency to your project:

```kotlin:title=build.gradle[.kts]
dependencies {
  // ...

  // For RxJava 2
  implementation("com.apollographql.apollo3:apollo-rx2-support:$version")

  // For RxJava 3
  implementation("com.apollographql.apollo3:apollo-rx3-support:$version")
}
```

## Executing operations

Use the `rxSingle` / `rxFlowable` extensions to execute GraphQL operations and get RxJava observables:

<MultiCodeBlock>

```java
import com.apollographql.apollo3.rx2.Rx2Apollo;

// (...)

// Query
ApolloQueryCall<MyQuery.Data> queryCall = client.query(new MyQuery());
Single<ApolloResponse<MyQuery.Data>> queryResponse = Rx2Apollo.single(queryCall);
queryResponse.subscribe( /* ... */ );

// Mutation
ApolloMutationCall<MyMutation.Data> mutationCall = client.mutation(new MyMutation("my-parameter"));
Single<ApolloResponse<MyMutation.Data>> mutationResponse = Rx2Apollo.single(mutationCall);
mutationResponse.subscribe( /* ... */ );

// Subscription
ApolloSubscriptionCall<MySubscription.Data> subscriptionCall = client.subscription(new MySubscription());
Flowable<ApolloResponse<MySubscription.Data>> subscriptionResponse = Rx2Apollo.flowable(subscriptionCall);
subscriptionResponse.subscribe( /* ... */ );
```

```kotlin
// Query
client.query(MyQuery()).rxSingle().subscribe(/* ... */)

// Mutation
client.mutation(MyMutation("my-parameter")).rxSingle().subscribe(/* ... */)

// Subscription
client.subscription(MySubscription()).rxFlowable().subscribe(/* ... */)
```
</MultiCodeBlock>

## `ApolloInterceptor`

To set an `ApolloInterceptor` on your `ApolloClient`, you can define an `Rx2ApolloInterceptor` or `Rx3ApolloInterceptor`:

<MultiCodeBlock>

```java
private static Rx2ApolloInterceptor rx2ApolloInterceptor = new Rx2ApolloInterceptor() {
  @NotNull
  @Override
  public <D extends Operation.Data> Flowable<ApolloResponse<D>> intercept(
    @NotNull ApolloRequest<D> request,
    @NotNull Rx2ApolloInterceptorChain chain
  ) {
    ApolloRequest<D> modifiedRequest = request.newBuilder() /* ... */.build();
    return chain.proceed(modifiedRequest);
  }
};
```

```kotlin
private val rx2ApolloInterceptor = object : Rx2ApolloInterceptor {
  override fun <D : Operation.Data> intercept(
    request: ApolloRequest<D>,
    chain: Rx2ApolloInterceptorChain
  ): Flowable<ApolloResponse<D>> {
    val modifiedRequest = request.newBuilder() /* ... */ .build()
    return chain.proceed(modifiedRequest)
  }
}
```
</MultiCodeBlock>


Then use the `toApolloInterceptor` extension to convert it to an `ApolloInterceptor` and add it to your `ApolloClient.Builder`:

<MultiCodeBlock>

```java{6}
import com.apollographql.apollo3.rx2.Rx2Conversion;
// (...)

ApolloClient client = new ApolloClient.Builder()
  .serverUrl("http://localhost:4000/graphql")
  .addInterceptor(Rx2Conversion.toApolloInterceptor(rx2ApolloInterceptor))
  .build();
```
```kotlin{3}
val client = ApolloClient.Builder()
  .serverUrl("http://localhost:4000/graphql")
  .addInterceptor(rx2ApolloInterceptor.toApolloInterceptor())
  .build()
```

</MultiCodeBlock>


## `HttpInterceptor`

Similarly, to use [`HttpInterceptor`s](interceptors-http), you can define an `Rx2HttpInterceptor` or `Rx3HttpInterceptor` like so:

<MultiCodeBlock>

```java
public static Rx2HttpInterceptor rx2HttpInterceptor = new Rx2HttpInterceptor() {
    @NotNull
    @Override
    public Single<HttpResponse> intercept(
        @NotNull HttpRequest request,
        @NotNull Rx2HttpInterceptorChain chain
    ) {
        HttpRequest modifiedRequest = request.newBuilder() /* ... */.build();
        return chain.proceed(modifiedRequest);
    }
};

```

```kotlin
private val rx2HttpInterceptor = object : Rx2HttpInterceptor {
  override fun intercept(request: HttpRequest, chain: Rx2HttpInterceptorChain): Single<HttpResponse> {
    val modifiedRequest = request.newBuilder() /* ... */.build()
    return chain.proceed(modifiedRequest)
  }
}
```
</MultiCodeBlock>

Then use the `toHttpInterceptor` extension to add it to your `ApolloClient.Builder` like so:

<MultiCodeBlock>

```java{10}
import com.apollographql.apollo3.rx2.Rx2Conversion;
// (...)

ApolloClient client = new ApolloClient.Builder()
  .networkTransport(
    new HttpNetworkTransport(
      "http://localhost:4000/graphql",
      10_000,
      10_000,
      List.of(Rx2Conversion.toHttpInterceptor(rx2HttpInterceptor))
    )
  )
.build();
```

```kotlin
val client = ApolloClient.Builder()
  .networkTransport(
    HttpNetworkTransport(
      serverUrl = "http://localhost:4000/graphql",
      interceptors = listOf(rx2HttpInterceptor.toHttpInterceptor())
    )
  )
  .build()
```

</MultiCodeBlock>

## Using the `ApolloStore`

> ⚠️ **The APIs in this section are experimental and subject to change.** If you have feedback on them, please let us know via [Github issues](https://github.com/apollographql/apollo-android/issues/new?assignees=&labels=Type%3A+Bug&template=bug_report.md&title=[Rx%20Support]) or in the [Kotlin Slack community](https://slack.kotl.in/).

The `ApolloStore` class enables you to interact with the [normalized cache](../../caching/normalized-cache). You can obtain an Rx version of it with the `toRx2ApolloStore` or `toRx3ApolloStore` extension:

<MultiCodeBlock>

```java{6}
import com.apollographql.apollo3.cache.normalized.NormalizedCache;
import com.apollographql.apollo3.rx2.Rx2Apollo;
// (...)

ApolloStore apolloStore = NormalizedCache.getApolloStore(client);
Rx2ApolloStore rxApolloStore = Rx2Apollo.toRx2ApolloStore(apolloStore, Schedulers.io());
Single<MyFragment> data = rxApolloStore.rxReadFragment(new MyFragmentImpl(), new CacheKey("..."), CustomScalarAdapters.Empty, CacheHeaders.NONE);
data.subscribe( /* ... */);
```

```kotlin{2}
val apolloStore = client.apolloStore
val rxApolloStore = apolloStore.toRx2ApolloStore()
val data: Single<MyFragment> = rxApolloStore.rxReadFragment(MyFragmentImpl(), CacheKey("..."))
data.subscribe( /* ... */)
```

</MultiCodeBlock>
