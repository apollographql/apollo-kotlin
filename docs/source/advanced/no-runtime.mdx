---
title: Using the client without apollo-runtime
---

import {MultiCodeBlock} from 'gatsby-theme-apollo-docs';

`apollo-runtime` and `ApolloClient` provides support for doing the network requests and interacting with the cache but you can use the generated models and parsers without the runtime and use your network layer of choice for the HTTP calls.

For this, remove the `com.apollographql.apollo3:apollo-runtime` dependency and replace it with:

```kotlin:title=build.gradle
implementation("com.apollographql.apollo3:apollo-api:x.y.z")
```

## Composing an HTTP request body

To compose an HTTP POST request body to be sent to your server, use `composeJsonRequest`:

<MultiCodeBlock>

```kotlin
val jsonRequest = query.composeJsonRequest()
val mediaType = MediaType.parse("application/json");
/**
 * jsonRequest contains data to be sent to the server
 * {
 *  "query": ...
 *  "variables": ...
 *  "extensions": ...
 * }
 */
val requestBody = RequestBody.create(mediaType, jsonRequest);
```

</MultiCodeBlock>


## Composing an HTTP response body

To compose a complete response that you can use during tests for an example, use `composeJsonResponse` with a programmatically built `data`:

```kotlin
/**
 * jsonResponse will contain a json with data and possibly errors:
 * {
 *  "data": ...
 *  "errors": ...
 *  "extensions": ...
 * }
 **/
val data = SomeQuery.Data(...)
val buffer = Buffer()
val jsonWriter = buffer.jsonWriter()
operation.composeJsonResponse(jsonWriter, data)
val jsonResponse = buffer.readUtf8()

mockServer.enqueue(jsonResponse)
```

## Parsing an HTTP response body

To parse a network response into the type safe models, use `parseJsonResponse`:

```kotlin
/**
 * jsonResponse should contain a json with data and possibly errors:
 * {
 *  "data": ...
 *  "errors": ...
 *  "extensions": ...
 * }
 **/
val jsonReader = Buffer().write(jsonResponse).jsonReader()
val response = operation.parseJsonResponse(jsonReader)

println(response.data)
```

